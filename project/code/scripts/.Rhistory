}
# modify the Birth.Date columns
player_data$Birth.Date = sapply(str_split(player_data$Birth.Date, "-"),
"[[",
1)
number_cols <- names(player_data[,!names(player_data) %in% text_fields])
# loop through all quantitative variable in roster-salary-stats data frame
for (field in number_cols) {
freq <- player_data %>%
dplyr::select_(field) %>%
dplyr::group_by_(field) %>%
dplyr::count() %>%
dplyr::arrange()
freq = as.data.frame(freq)
# boxplot for quantitative variables
switch(
field,
Number = {
aes = aes(x = Number , y = n)
aes1 = aes(x = Number)
},
Weight = {
aes = aes(x = Weight , y = n)
aes1 = aes(x = Weight)
},
Experience = {
aes = aes(x = Experience , y = n)
aes1 = aes(x = Experience)
},
Age = {
aes = aes(x = Age , y = n)
aes1 = aes(x = Age)
},
Games_Started = {
aes = aes(x = Games_Started , y = n)
aes1 = aes(x = Games_Started)
},
Field_Goals =  {
aes = aes(x = Field_Goals , y = n)
aes1 = aes(x = Field_Goals)
},
Field_Goal_Percentage = {
aes = aes(x = Field_Goal_Percentage , y = n)
aes1 = aes(x = Field_Goal_Percentage)
},
X3.Point_Field_Goal_Attempts = {
aes = aes(x = X3.Point_Field_Goal_Attempts , y = n)
aes1 = aes(x = X3.Point_Field_Goal_Attempts)
},
X2.Point_Field_Goals = {
aes = aes(x = X2.Point_Field_Goals , y = n)
aes1 = aes(x = X2.Point_Field_Goals)
},
X2.Point_Field_Goal_Percentage = {
aes = aes(x = X2.Point_Field_Goal_Percentage , y = n)
aes1 = aes(x = X2.Point_Field_Goal_Percentage)
},
Free_Throws = {
aes = aes(x = Free_Throws , y = n)
aes1 = aes(x = Free_Throws)
},
Free_Throw_Percentage = {
aes = aes(x = Free_Throw_Percentage , y = n)
aes1 = aes(x = Free_Throw_Percentage)
},
Defensive_Rebounds = {
aes = aes(x = Defensive_Rebounds , y = n)
aes1 = aes(x = Defensive_Rebounds)
},
Assists = {
aes = aes(x = Assists , y = n)
aes1 = aes(x = Assists)
},
Blocks = {
aes = aes(x = Blocks , y = n)
aes1 = aes(x = Blocks)
},
Personal.Fouls = {
aes = aes(x = Personal.Fouls , y = n)
aes1 = aes(x = Personal.Fouls)
},
Rank_Salary = {
aes = aes(x = Rank_Salary , y = n)
aes1 = aes(x = Rank_Salary)
},
Height = {
aes = aes(x = Height , y = n)
aes1 = aes(x = Height)
},
Birth.Date = {
aes = aes(x = Birth.Date , y = n)
aes1 = aes(x = Birth.Date)
},
Rank_Totals = {
aes = aes(x = Rank_Totals , y = n)
aes1 = aes(x = Rank_Totals)
},
Games = {
aes = aes(x = Games , y = n)
aes1 = aes(x = Games)
},
Minutes_Played = {
aes = aes(x = Minutes_Played , y = n)
aes1 = aes(x = Minutes_Played)
},
Field_Goal_Attempts = {
aes = aes(x = Field_Goal_Attempts , y = n)
aes1 = aes(x = Field_Goal_Attempts)
},
X3.Point_Field_Goals = {
aes = aes(x = X3.Point_Field_Goals , y = n)
aes1 = aes(x = X3.Point_Field_Goals)
},
X3.Point_Field_Goal_Percentage = {
aes = aes(x = X3.Point_Field_Goal_Percentage , y = n)
aes1 = aes(x = X3.Point_Field_Goal_Percentage)
},
X2.point_Field_Goal_Attempts = {
aes = aes(x = X2.point_Field_Goal_Attempts , y = n)
aes1 = aes(x = X2.point_Field_Goal_Attempts)
},
Effective_Field_Goal_Percentage = {
aes = aes(x = Effective_Field_Goal_Percentage , y = n)
aes1 = aes(x = Effective_Field_Goal_Percentage)
},
Free_Throw_Attempts = {
aes = aes(x = Free_Throw_Attempts , y = n)
aes1 = aes(x = Free_Throw_Attempts)
},
Offensive_Rebounds = {
aes = aes(x = Offensive_Rebounds , y = n)
aes1 = aes(x = Offensive_Rebounds)
},
Total_Rebounds = {
aes = aes(x = Total_Rebounds , y = n)
aes1 = aes(x = Total_Rebounds)
},
Steals = {
aes = aes(x = Steals , y = n)
aes1 = aes(x = Steals)
},
Turnovers = {
aes = aes(x = Turnovers , y = n)
aes1 = aes(x = Turnovers)
},
Points = {
aes = aes(x = Points , y = n)
aes1 = aes(x = Points)
},
Salary = {
aes = aes(x = Salary , y = n)
aes1 = aes(x = Salary)
}
)
# plotting box plot
p <- ggplot(freq, aes) + geom_boxplot()
p <- p + ylab("Frequency")
p <- p + theme(axis.text.x = element_text(face = "bold",
size = rel(1.1)))
p <- p + theme(axis.text.y = element_text(face = "bold",
size = rel(1.1)))
p <- p + theme(axis.title.x = element_text(size = 12, face = "bold"))
p <- p + theme(axis.title.y = element_text(size = 12, face = "bold"))
p <- p + ggtitle(paste("Frequency of", noquote(field))) +
theme(plot.title = element_text(size = rel(1.2), face = "bold"))
# plotting histogram
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "bin", binwidth = NULL,fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his <- p_his + theme(axis.text.x = element_text(face = "bold",
size = rel(1.1)))
p_his <- p_his + theme(axis.text.y = element_text(face = "bold",
size = rel(1.1)))
p_his <- p_his + theme(axis.title.x = element_text(size = 12,
face = "bold"))
p_his <- p_his + theme(axis.title.y = element_text(size = 12,
face = "bold"))
p_his <- p_his + ggtitle(paste("His of Frequency of", noquote(field))) +
theme(plot.title = element_text(size = rel(1.2), face = "bold"))
png(
filename = paste0(noquote(field), ".png"),
width = 800,
height = 500
)
plot(p_his)
# save plot in png format to file images
png(
filename = paste0(noquote(field), ".png"),
width = 800,
height = 500
)
plot(p)
dev.off()
dev.off()
}
}
create_box_histogram <- function(player_data, text_fields) {
# checking inputs
if (class(full_player_table) != "data.frame" ||
class(text_fields) != "character") {
stop("Please check input types to 'create_summary_file'.")
}
# modify the Birth.Date columns
player_data$Birth.Date = sapply(str_split(player_data$Birth.Date, "-"),
"[[",
1)
number_cols <- names(player_data[,!names(player_data) %in% text_fields])
# loop through all quantitative variable in roster-salary-stats data frame
for (field in number_cols) {
freq <- player_data %>%
dplyr::select_(field) %>%
dplyr::group_by_(field) %>%
dplyr::count() %>%
dplyr::arrange()
freq = as.data.frame(freq)
# boxplot for quantitative variables
switch(
field,
Number = {
aes = aes(x = Number , y = n)
aes1 = aes(x = Number)
},
Weight = {
aes = aes(x = Weight , y = n)
aes1 = aes(x = Weight)
},
Experience = {
aes = aes(x = Experience , y = n)
aes1 = aes(x = Experience)
},
Age = {
aes = aes(x = Age , y = n)
aes1 = aes(x = Age)
},
Games_Started = {
aes = aes(x = Games_Started , y = n)
aes1 = aes(x = Games_Started)
},
Field_Goals =  {
aes = aes(x = Field_Goals , y = n)
aes1 = aes(x = Field_Goals)
},
Field_Goal_Percentage = {
aes = aes(x = Field_Goal_Percentage , y = n)
aes1 = aes(x = Field_Goal_Percentage)
},
X3.Point_Field_Goal_Attempts = {
aes = aes(x = X3.Point_Field_Goal_Attempts , y = n)
aes1 = aes(x = X3.Point_Field_Goal_Attempts)
},
X2.Point_Field_Goals = {
aes = aes(x = X2.Point_Field_Goals , y = n)
aes1 = aes(x = X2.Point_Field_Goals)
},
X2.Point_Field_Goal_Percentage = {
aes = aes(x = X2.Point_Field_Goal_Percentage , y = n)
aes1 = aes(x = X2.Point_Field_Goal_Percentage)
},
Free_Throws = {
aes = aes(x = Free_Throws , y = n)
aes1 = aes(x = Free_Throws)
},
Free_Throw_Percentage = {
aes = aes(x = Free_Throw_Percentage , y = n)
aes1 = aes(x = Free_Throw_Percentage)
},
Defensive_Rebounds = {
aes = aes(x = Defensive_Rebounds , y = n)
aes1 = aes(x = Defensive_Rebounds)
},
Assists = {
aes = aes(x = Assists , y = n)
aes1 = aes(x = Assists)
},
Blocks = {
aes = aes(x = Blocks , y = n)
aes1 = aes(x = Blocks)
},
Personal.Fouls = {
aes = aes(x = Personal.Fouls , y = n)
aes1 = aes(x = Personal.Fouls)
},
Rank_Salary = {
aes = aes(x = Rank_Salary , y = n)
aes1 = aes(x = Rank_Salary)
},
Height = {
aes = aes(x = Height , y = n)
aes1 = aes(x = Height)
},
Birth.Date = {
aes = aes(x = Birth.Date , y = n)
aes1 = aes(x = Birth.Date)
},
Rank_Totals = {
aes = aes(x = Rank_Totals , y = n)
aes1 = aes(x = Rank_Totals)
},
Games = {
aes = aes(x = Games , y = n)
aes1 = aes(x = Games)
},
Minutes_Played = {
aes = aes(x = Minutes_Played , y = n)
aes1 = aes(x = Minutes_Played)
},
Field_Goal_Attempts = {
aes = aes(x = Field_Goal_Attempts , y = n)
aes1 = aes(x = Field_Goal_Attempts)
},
X3.Point_Field_Goals = {
aes = aes(x = X3.Point_Field_Goals , y = n)
aes1 = aes(x = X3.Point_Field_Goals)
},
X3.Point_Field_Goal_Percentage = {
aes = aes(x = X3.Point_Field_Goal_Percentage , y = n)
aes1 = aes(x = X3.Point_Field_Goal_Percentage)
},
X2.point_Field_Goal_Attempts = {
aes = aes(x = X2.point_Field_Goal_Attempts , y = n)
aes1 = aes(x = X2.point_Field_Goal_Attempts)
},
Effective_Field_Goal_Percentage = {
aes = aes(x = Effective_Field_Goal_Percentage , y = n)
aes1 = aes(x = Effective_Field_Goal_Percentage)
},
Free_Throw_Attempts = {
aes = aes(x = Free_Throw_Attempts , y = n)
aes1 = aes(x = Free_Throw_Attempts)
},
Offensive_Rebounds = {
aes = aes(x = Offensive_Rebounds , y = n)
aes1 = aes(x = Offensive_Rebounds)
},
Total_Rebounds = {
aes = aes(x = Total_Rebounds , y = n)
aes1 = aes(x = Total_Rebounds)
},
Steals = {
aes = aes(x = Steals , y = n)
aes1 = aes(x = Steals)
},
Turnovers = {
aes = aes(x = Turnovers , y = n)
aes1 = aes(x = Turnovers)
},
Points = {
aes = aes(x = Points , y = n)
aes1 = aes(x = Points)
},
Salary = {
aes = aes(x = Salary , y = n)
aes1 = aes(x = Salary)
}
)
# plotting box plot
p <- ggplot(freq, aes) + geom_boxplot()
p <- p + ylab("Frequency")
p <- p + theme(axis.text.x = element_text(face = "bold",
size = rel(1.1)))
p <- p + theme(axis.text.y = element_text(face = "bold",
size = rel(1.1)))
p <- p + theme(axis.title.x = element_text(size = 12, face = "bold"))
p <- p + theme(axis.title.y = element_text(size = 12, face = "bold"))
p <- p + ggtitle(paste("Frequency of", noquote(field))) +
theme(plot.title = element_text(size = rel(1.2), face = "bold"))
# plotting histogram
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "bin", binwidth = NULL,fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his <- p_his + theme(axis.text.x = element_text(face = "bold",
size = rel(1.1)))
p_his <- p_his + theme(axis.text.y = element_text(face = "bold",
size = rel(1.1)))
p_his <- p_his + theme(axis.title.x = element_text(size = 12,
face = "bold"))
p_his <- p_his + theme(axis.title.y = element_text(size = 12,
face = "bold"))
p_his <- p_his + ggtitle(paste("His of Frequency of", noquote(field))) +
theme(plot.title = element_text(size = rel(1.2), face = "bold"))
png(
filename = paste0(noquote(field), ".png"),
width = 800,
height = 500
)
plot(p_his) # save plot in png format to file images
png(
filename = paste0(noquote(field), ".png"),
width = 800,
height = 500
)
plot(p)
dev.off()
dev.off()
}
}
text_fields <- c("Player",
"Team",
"Position",
"Country",
"College")
create_box_histogram(player_data, text_fields)
c = seq(from = 1, to = 39, by = 1)
c
player_Data
player_data
col_number = seq(from = 1, to = 39, by = 1)
for (idx in col_number) {
player_data[, idx][which(is.na(player_data[, idx]))] <-  "NA"
}
player_data[,18]
field
freq <- player_data %>%
dplyr::select_(field) %>%
dplyr::group_by_(field) %>%
dplyr::count() %>%
dplyr::arrange()
freq = as.data.frame(freq)
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "bin", binwidth = NULL,fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
p_his <- ggplot(player_data, aes1) +
geom_histogram( binwidth = NULL,fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "count", binwidth = NULL,fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "count",fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
p_his <- ggplot(player_data, aes1) +
geom_histogram(stat = "count",fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- ggplot(player_data, aes1) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
aes1
p_his <- ggplot(player_data, aes(x = Salary)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
str(player_data)
p_his <- ggplot(player_data, aes(x = Free_Throw_Percentage)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
full_player_table <- read.csv(t_location,
stringsAsFactors = FALSE)
full_player_table$Birth.Date <-
as.Date(full_player_table$Birth.Date)
player_data= full_player_table
p_his <- ggplot(player_data, aes(x = Free_Throw_Percentage)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
p_his <- ggplot(player_data, aes(x = Free_Throw_Percentage)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his
str(player_data)
p_his <- ggplot(player_data, aes(x = Effective_Field_Goal_Percentage)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his
t_location <- "../../data/cleandata/roster-salary-stats.csv"
full_player_table <- read.csv(t_location,
stringsAsFactors = FALSE)
full_player_table$Birth.Date <-
as.Date(full_player_table$Birth.Date)
player_data = full_player_table
p_his <- ggplot(player_data, aes(x = Effective_Field_Goal_Percentage)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his <- p_his + ylab("Frequency")
p_his
plot(p_his)
view(p_his_)
view(p_his)
p_his
p_his <- ggplot(player_data, aes(x = Salary)) +
geom_histogram(fill = "#00BFC4",
colour = "black",
size = .2)
p_his

new_path
old_path <- str_c("C:/Users/Nicolas Min/Documents/stat133-hw4/", t2)
new_path <- str_c("C:/Users/Nicolas Min/Documents/stat133-hw4/txt_files/", t2)
file.rename (from = old_path, to = new_path)
for(i in 1:length(old_path)) {
file.rename(old_path[i], new_path[i])
}
t1 <- list.files("C:/Users/Nicolas Min/Documents/stat133-hw4")
list.files("C:/Users/Nicolas Min/Documents/stat133-hw4")
str_match_all(t1, "txt")
str_match_all(t1, "*txt")
t2 <- str_match_all(t1, "*.txt")
str_match_all(t1, "*.txt")
str_extract_all(t1, "txt")
str_match_all(t1, "*txt")
t1
str_match_all(t1, "txt")
t2 <- str_extract_all(t1, "txt")
str_extract_all(t1, "txt")
str_extract_all(t1, "*\\.txt")
str_extract_all(t1, "*\.txt")
str_extract_all(t1, "*.txt")
str_extract_all(string = t1, pattern = "*.txt")
str_extract_all(string = t1, pattern = "*.txt", simplify = TRUE)
str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE)
str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE)
str_extract_all(string = t1, pattern = ".+txt", simplify = FALSE)
str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE)
str_match_all(string = t1, pattern = ".+txt", simplify = TRUE)
str_match_all(string = t1, pattern = ".+txt")
str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE)
as.vector(str_match_all(string = t1, pattern = ".+txt"))
as.vector(str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE))
t2 <- as.vector(str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE))
as.vector(str_extract_all(string = t1, pattern = ".+txt", simplify = TRUE))
t2[t2!==""]
library(XML)
library(dplyr)
# load data file, "roster-salary-stats.csv".
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
team_data <- read.csv(file = "../../data/cleandata/roster-salary-stats.csv",
sep = ",")
View(team_data)
# subset data for position 'PG' (point guard)
# and add columns, "Missed_Field_Goals", "Missed_Free_Throws", and "Turnovers"
# (these variables have negative sign)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
# statistics for efficiency
stats <- c('Points', 'Total_Rebounds', 'Assists', 'Steals', 'Blocks', 'Missed_Field_Goals',
'Missed_Free_Throws', 'Turnovers')
# all variables are divided by number of games
X1 <- as.matrix(c[ ,stats] / c$Games)
print(round(cor(X1), 2), print.gap = 2)
X2 <- as.matrix(pf[ ,stats] / pf$Games)
print(round(cor(X2), 2), print.gap = 2)
X3 <- as.matrix(pg[ ,stats] / pg$Games)
print(round(cor(X3), 2), print.gap = 2)
X4 <- as.matrix(sf[ ,stats] / sf$Games)
print(round(cor(X4), 2), print.gap = 2)
X5 <- as.matrix(sg[ ,stats] / sg$Games)
print(round(cor(X5), 2), print.gap = 2)
# PCA with prcomp()
c_pca <- prcomp(X1, center = TRUE, scale. = TRUE)
c_weights <- c_pca$rotation[,1]
pf_pca <- prcomp(X2, center = TRUE, scale. = TRUE)
pf_weights <- pf_pca$rotation[,1]
pg_pca <- prcomp(X3, center = TRUE, scale. = TRUE)
pg_weights <- pg_pca$rotation[,1]
sf_pca <- prcomp(X4, center = TRUE, scale. = TRUE)
sf_weights <- sf_pca$rotation[,1]
sg_pca <- prcomp(X5, center = TRUE, scale. = TRUE)
sg_weights <- sg_pca$rotation[,1]
# std deviations for each columns
c_sigmas <- apply(X1, 2, sd)
pf_sigmas <- apply(X2, 2, sd)
pg_sigmas <- apply(X3, 2, sd)
sf_sigmas <- apply(X4, 2, sd)
sg_sigmas <- apply(X5, 2, sd)
# modified efficiency
c_eff <- X1 %*% (c_weights / c_sigmas)
c$EFF <- c_eff
pf_eff <- X2 %*% (pf_weights / pf_sigmas)
pf$EFF <- pf_eff
pg_eff <- X3 %*% (pg_weights / pg_sigmas)
pg$EFF <- pg_eff
sf_eff <- X4 %*% (sf_weights / sf_sigmas)
sf$EFF <- sf_eff
sg_eff <- X5 %*% (sg_weights / sg_sigmas)
sg$EFF <- sg_eff
#Create data set "eff-stats-salary.csv"
# Modify team_data
team_data_modified <- rbind(c, pf, pg, sf, sg)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks, Missed_Field_Goals,
Missed_Free_Throws, Turnovers, Games, EFF, Salary)
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks, -Missed_Field_Goals,
-Missed_Free_Throws, -Turnovers, Games, EFF, Salary)
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers) %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary)
team_data_modified <- rbind(c, pf, pg, sf, sg)
eff_stats_salary <- team_data_modified %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers) %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary)
eff_stats_salary <- team_data_modified %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
transmute(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
transmute(Turnovers = -1 * Turnovers) %>%
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary)
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws)
team_data_modified <- rbind(c, pf, pg, sf, sg)
View(team_data_modified)
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
transmute(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
transmute(Turnovers = -1 * Turnovers)
sg
c_eff <- X1 %*% (c_weights / c_sigmas)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
View(c)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
transmute(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
transmute(Turnovers = -1 * Turnovers)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
View(sg)
library(dplyr)
# load data file, "roster-salary-stats.csv".
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
team_data <- read.csv(file = "../../data/cleandata/roster-salary-stats.csv",
sep = ",")
View(team_data)
# subset data for position 'PG' (point guard)
# and add columns, "Missed_Field_Goals", "Missed_Free_Throws", and "Turnovers"
# (these variables have negative sign)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
# statistics for efficiency
stats <- c('Points', 'Total_Rebounds', 'Assists', 'Steals', 'Blocks', 'Missed_Field_Goals',
'Missed_Free_Throws', 'Turnovers')
# all variables are divided by number of games
X1 <- as.matrix(c[ ,stats] / c$Games)
print(round(cor(X1), 2), print.gap = 2)
X2 <- as.matrix(pf[ ,stats] / pf$Games)
print(round(cor(X2), 2), print.gap = 2)
X3 <- as.matrix(pg[ ,stats] / pg$Games)
print(round(cor(X3), 2), print.gap = 2)
X4 <- as.matrix(sf[ ,stats] / sf$Games)
print(round(cor(X4), 2), print.gap = 2)
X5 <- as.matrix(sg[ ,stats] / sg$Games)
print(round(cor(X5), 2), print.gap = 2)
# PCA with prcomp()
c_pca <- prcomp(X1, center = TRUE, scale. = TRUE)
c_weights <- c_pca$rotation[,1]
pf_pca <- prcomp(X2, center = TRUE, scale. = TRUE)
pf_weights <- pf_pca$rotation[,1]
pg_pca <- prcomp(X3, center = TRUE, scale. = TRUE)
pg_weights <- pg_pca$rotation[,1]
sf_pca <- prcomp(X4, center = TRUE, scale. = TRUE)
sf_weights <- sf_pca$rotation[,1]
sg_pca <- prcomp(X5, center = TRUE, scale. = TRUE)
sg_weights <- sg_pca$rotation[,1]
# std deviations for each columns
c_sigmas <- apply(X1, 2, sd)
pf_sigmas <- apply(X2, 2, sd)
pg_sigmas <- apply(X3, 2, sd)
sf_sigmas <- apply(X4, 2, sd)
sg_sigmas <- apply(X5, 2, sd)
c_eff <- X1 %*% (c_weights / c_sigmas)
pf_eff <- X2 %*% (pf_weights / pf_sigmas)
pg_eff <- X3 %*% (pg_weights / pg_sigmas)
sf_eff <- X4 %*% (sf_weights / sf_sigmas)
sg_eff <- X5 %*% (sg_weights / sg_sigmas)
c_eff <- X1 %*% (c_weights / c_sigmas)
pf_eff <- X2 %*% (pf_weights / pf_sigmas)
pg_eff <- X3 %*% (pg_weights / pg_sigmas)
sf_eff <- X4 %*% (sf_weights / sf_sigmas)
sg_eff <- X5 %*% (sg_weights / sg_sigmas)
View(c)
team_data_modified <- rbind(c, pf, pg, sf, sg)
team_data_modified
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
transmute(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
transmute(Turnovers = -1 * Turnovers)
library(dplyr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
team_data <- read.csv(file = "../../data/cleandata/roster-salary-stats.csv",
sep = ",")
View(team_data)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
stats <- c('Points', 'Total_Rebounds', 'Assists', 'Steals', 'Blocks', 'Missed_Field_Goals',
'Missed_Free_Throws', 'Turnovers')
# all variables are divided by number of games
X1 <- as.matrix(c[ ,stats] / c$Games)
print(round(cor(X1), 2), print.gap = 2)
X2 <- as.matrix(pf[ ,stats] / pf$Games)
print(round(cor(X2), 2), print.gap = 2)
X3 <- as.matrix(pg[ ,stats] / pg$Games)
print(round(cor(X3), 2), print.gap = 2)
X4 <- as.matrix(sf[ ,stats] / sf$Games)
print(round(cor(X4), 2), print.gap = 2)
X5 <- as.matrix(sg[ ,stats] / sg$Games)
print(round(cor(X5), 2), print.gap = 2)
c_pca <- prcomp(X1, center = TRUE, scale. = TRUE)
c_weights <- c_pca$rotation[,1]
pf_pca <- prcomp(X2, center = TRUE, scale. = TRUE)
pf_weights <- pf_pca$rotation[,1]
pg_pca <- prcomp(X3, center = TRUE, scale. = TRUE)
pg_weights <- pg_pca$rotation[,1]
sf_pca <- prcomp(X4, center = TRUE, scale. = TRUE)
sf_weights <- sf_pca$rotation[,1]
sg_pca <- prcomp(X5, center = TRUE, scale. = TRUE)
sg_weights <- sg_pca$rotation[,1]
c_sigmas <- apply(X1, 2, sd)
pf_sigmas <- apply(X2, 2, sd)
pg_sigmas <- apply(X3, 2, sd)
sf_sigmas <- apply(X4, 2, sd)
sg_sigmas <- apply(X5, 2, sd)
c_eff <- X1 %*% (c_weights / c_sigmas)
pf_eff <- X2 %*% (pf_weights / pf_sigmas)
pg_eff <- X3 %*% (pg_weights / pg_sigmas)
sf_eff <- X4 %*% (sf_weights / sf_sigmas)
sg_eff <- X5 %*% (sg_weights / sg_sigmas)
c_eff
team_data_modified <- rbind(c, pf, pg, sf, sg)
View (team_data_modified)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
View(sg)
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
transmute(Missed_Free_Throws = -1* Missed_Free_Throws)
team_data_modified
View (team_data_modified)
library(dplyr)
# load data file, "roster-salary-stats.csv".
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
team_data <- read.csv(file = "../../data/cleandata/roster-salary-stats.csv",
sep = ",")
View(team_data)
# subset data for position 'PG' (point guard)
# and add columns, "Missed_Field_Goals", "Missed_Free_Throws", and "Turnovers"
# (these variables have negative sign)
c <- team_data %>%
filter(Position == 'C') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pf <- team_data %>%
filter(Position == 'PF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
pg <- team_data %>%
filter(Position == 'PG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sf <- team_data %>%
filter(Position == 'SF') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
sg <- team_data %>%
filter(Position == 'SG') %>%
mutate(Missed_Free_Throws = Free_Throws - Free_Throw_Attempts) %>%
mutate(Missed_Field_Goals = Field_Goals - Field_Goal_Attempts) %>%
mutate(Turnovers = -1 * Turnovers)
View(sg)
# statistics for efficiency
stats <- c('Points', 'Total_Rebounds', 'Assists', 'Steals', 'Blocks', 'Missed_Field_Goals',
'Missed_Free_Throws', 'Turnovers')
# all variables are divided by number of games
X1 <- as.matrix(c[ ,stats] / c$Games)
print(round(cor(X1), 2), print.gap = 2)
X2 <- as.matrix(pf[ ,stats] / pf$Games)
print(round(cor(X2), 2), print.gap = 2)
X3 <- as.matrix(pg[ ,stats] / pg$Games)
print(round(cor(X3), 2), print.gap = 2)
X4 <- as.matrix(sf[ ,stats] / sf$Games)
print(round(cor(X4), 2), print.gap = 2)
X5 <- as.matrix(sg[ ,stats] / sg$Games)
print(round(cor(X5), 2), print.gap = 2)
# PCA with prcomp()
c_pca <- prcomp(X1, center = TRUE, scale. = TRUE)
c_weights <- c_pca$rotation[,1]
pf_pca <- prcomp(X2, center = TRUE, scale. = TRUE)
pf_weights <- pf_pca$rotation[,1]
pg_pca <- prcomp(X3, center = TRUE, scale. = TRUE)
pg_weights <- pg_pca$rotation[,1]
sf_pca <- prcomp(X4, center = TRUE, scale. = TRUE)
sf_weights <- sf_pca$rotation[,1]
sg_pca <- prcomp(X5, center = TRUE, scale. = TRUE)
sg_weights <- sg_pca$rotation[,1]
# std deviations for each columns
c_sigmas <- apply(X1, 2, sd)
pf_sigmas <- apply(X2, 2, sd)
pg_sigmas <- apply(X3, 2, sd)
sf_sigmas <- apply(X4, 2, sd)
sg_sigmas <- apply(X5, 2, sd)
# modified efficiency
c_eff <- X1 %*% (c_weights / c_sigmas)
pf_eff <- X2 %*% (pf_weights / pf_sigmas)
pg_eff <- X3 %*% (pg_weights / pg_sigmas)
sf_eff <- X4 %*% (sf_weights / sf_sigmas)
sg_eff <- X5 %*% (sg_weights / sg_sigmas)
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers)
View (team_data_modified)
EFF <-rbind(c_eff, pf_eff)
View(EFF)
EFF$EFF <-rbind(c_eff, pf_eff)
View(EFF)
EFF<-rbind(c_eff, pf_eff, pg_eff, sf_eff, sg_eff)
View(EFF)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, EFF, Salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, Salary)
View(eff_stats_salary)
str(c_eff)
c$EFF <- c_eff
str(c$EFF)
c$EFF <- c_eff
pf$EFF <- pf_eff
pg$EFF <- pg_eff
sf$EFF <- sf_eff
sg$EFF <- sg_eff
team_data_modified <- rbind(c, pf, pg, sf, sg)
team_data_modified <- rbind(c, pf, pg, sf, sg) %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers)
team_data_modified <- rbind(c, pf, pg, sf, sg)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, Salary)
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks,
Missed_Field_Goals, Missed_Free_Throws, Turnovers, Games, Salary) %>%
mutate(Missed_Free_Throws = -1* Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers)
View(eff_stats_salary)
team_data_modified <- rbind(c, pf, pg, sf, sg)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks, Missed_Field_Goals,
Missed_Free_Throws, Turnovers, Games, EFF, Salary)
View(eff_stats_salary)
eff_stats_salary <- team_data_modified %>%
select (Player, Points, Total_Rebounds, Assists, Steals, Blocks, Missed_Field_Goals,
Missed_Free_Throws, Turnovers, Games, EFF, Salary) %>%
mutate(Missed_Free_Throws = -1 * Missed_Free_Throws) %>%
mutate(Missed_Field_Goals = -1 * Missed_Field_Goals) %>%
mutate(Turnovers = -1 * Turnovers)
